developer installation for windows
==================================

This file is supposed to guide you step by step to have working (compiling) version of Powiter on windows. Right now, only a Visual studio 2010 solution file is proposed.

##Note

If you're not a Visual studio user, maybe in the future the QtCreator project file will get updated so it works on all platforms. For now you'd have to stick to Visual studio on windows, or make you're own project files.

If you're planning on writing a CMAKE based project file, and that you succeed in making it portable(windows/linux/osx), please send a mail at immarespond at gmail dot com.

##Install libraries

In order to have Powiter compiling, first you need to install the required libraries.

###Qt 4.8.5

You'll need to install Qt libraries from [Qt download](http://qt-project.org/downloads). 

###FFMPEG

You can retrieve pre-built binaries from (ffmpeg zeranoe build)[http://ffmpeg.zeranoe.com/builds/] . Select the developer files for the version of your system (32/64bits).


###OpenEXR 2.0.0

This one is not easy. You have two solutions, either you can get the binaries I compiled for windows on dropbox, or you can download it from :
(OpenEXR on github)[https://github.com/openexr/openexr] and compile it yourself. Warning : the .sln file provided to compile openexr does not include all the source files (especially the recently added deep compositing source files).

Here's the dropbox link for 32bit binaries :(Dropbox link)[https://www.dropbox.com/sh/k3t7ycow3a45e54/P3pg62FCBr]

(64bit) will come soon.

If you're having troubles to compile OpenEXR , here's some documentation: 

http://hebbut.net/Public.Offerings/OpenEXR.html

http://michael-stengel.com/blog/?p=51

http://www.fixstars.com/en/lucille/docs/dev/index.php/How_to_build_OpenEXR_libs_for_Win_64bit

###freetype2


Compile it by yourself from (Freetype download)[http://download.savannah.gnu.org/releases/freetype/] (make sure to download freetype 2.x). It should be pretty much straight forward. Powiter does a static link with freetype, make sure to build it as a static library.

###ftgl

Download it and compile it yourself from (FTGL download)[http://sourceforge.net/projects/ftgl/]. It should be pretty much straight forward. Powiter does a static link with freetype, make sure to build it as a static library.


###boost

Boost headers are required, but not the libraries. You can download boost from 
(boost download)[http://www.boost.org/users/download/]

###glew
On windows,OpenGL API is not up to date to the features we need. You'll need to download glew, that provides a recent version of the OpenGL API:

(glew download)[http://glew.sourceforge.net/]

### Eigen

Download Eigen from (eigen website)[http://eigen.tuxfamily.org/index.php?title=Main_Page]

### OpenFX

In the Powiter_Core directory, open a terminal and type
	git submodule update -i
This will properly fetch from github a fork of OpenFX into Powiter_Core/libs/OpenFX.
Got into OpenFX/HostSupport, and open the .sln file with visual studio. Note that this is a vs2005 solution file and if you have a greater version of visual, it will ask for conversion. Do it.
Once the project is loaded,change the active build configuration to Release if necessary.
Right click on the HostSupport project, click properties.
In the panel, go under Configuration Properties --> C/C++ --> Code Generation. Make sure that the current configuration (displayed in the combobox on the top of the panel) is set to Release-Static. Now the panel displayed for the Code Generation must match these settings, otherwise it will not link with Powiter:

Enable Minimal Rebuild : No
Enable C++ Exceptions : Yes
Smaller Type check : No
Basic RunTime checks: Default
Runtime Library : Multi-threaded DLL (/MD)
Struct member alignement : Default
Buffer Security check: Yes
Enable enhanced instruction set: Not set
Floating point model: Precise

Now you can click Apply and OK. Right click on the "Solution 'HostSupport'" in the Solution explorer and click Build Solution.
It should build everything needed under a directory named as such : HostSupport-Release-Static-Win32

If you'd like to generate a debug version of the library you can reproduce the steps for the Release version, but instead, in the Code Generation properties, you must set the Runtime Library to 
Multi-threaded Debug DLL (/MDd).

We're done here for libraries.

###Add the config.pri file

You have to define the locations of the required libraries. This is done by creating a .pri file that will tell the .pro where to find those libraries.

- create the config.pri file next to the Powiter.pro file.

You can fill it with the following proposed code to point to the libraries. Of course you need to provide valid paths that are valid on your system. Note that for Qt you just need to specify where the include files are.
For Eigen some issues might arise if it is already included in the system search path. Generally I left the eigen{} field blank in the config.pro to work around it.

INCLUDEPATH is the path to the include files

LIBS is the path to the libs

openexr{
    INCLUDEPATH += $$quote(C:\\Program Files\OpenExr_win32\include)
    LIBS += -L$$quote(C:\\Program Files\OpenExr_win32\lib\Debug) -lIlmimf -lIex -lImath -lHalf -lIlmThread
}

ftgl{
    INCLUDEPATH +=  $$quote(C:\\Program Files\ftgl_win32\include)
    LIBS += -L$$quote(C:\\Program Files\ftgl_win32\lib) -lftgl
}
ffmpeg{
    INCLUDEPATH +=  $$quote(C:\\Program Files\ffmpeg_win32\include)
    LIBS += -L$$quote(C:\\Program Files\ffmpeg_win32\lib)  -lavcodec -lavformat -lavutil -lswscale -lavdevice -lavfilter
}

freetype2{
    INCLUDEPATH += $$quote(C:\\Program Files\freetype2_win32\include)
    LIBS += -L$$quote(C:\\Program Files\freetype2_win32\lib) -lfreetype242MT
}

boost{
    INCLUDEPATH +=  $$quote(C:\\)
}

glew{
    INCLUDEPATH +=  $$quote(C:\\glew\include)
    LIBS += -L$$quote(C:\\glew\lib\Release) -lglew32
}



###Copy the dll's over

Copy all the required dll's to the executable directory.
If Powiter launches that means you got it all right;)

###Build on QtCreator
Untested yet.

###(Optional) Build on Visual Studio:

You need to install the Qt add-in for visual studio. Open the Qt menu within visual studio and select open a .pro file. This will generate a proper .sln working with qt command line tools.

